<?xml version="1.0" encoding="UTF-8"?>
<!--<!DOCTYPE article PUBLIC "-//OASIS//DTD Simplied DocBook XML V1.1//EN" "http://www.oasis-open.org/docbook/xml/simple/1.1/sdocbook.dtd"-->
<!--<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" "http://www.oasis-open.org/docbook/xml/4.3/docbookx.dtd"-->
<!DOCTYPE article PUBLIC "-//OASIS//DTD DocBook XML V4.3//EN" "../Common/docbook/xml/4.3/docbookx.dtd"
[
	<!ENTITY downloads SYSTEM "../Common/download.xml">
	<!ENTITY name "V1TeamCity">
	]>
<article id="v1ccnetpublisher.user">
	<title>VersionOne TeamCity Integration</title>
	<section id="description">
		<title>Description</title>
		<para>
			The VersionOne TeamCity integration creates a record of TeamCity builds in VersionOne, so the development teams can associate 
			stories and defects to a particular build. This visibility is useful when identifying problem builds or generating release notes.
		</para>
		<para>				
			Once the TeamCity Notifier has been installed, team members include a VersionOne identifier , such as “S-01454” or "TK-01234", in the comments of their SCM 
			commit .  Every time a build executes the Notifier creates a BuildRun asset in VersionOne with details of the build.  If the build comment contains
			story or defect IDs, the Notifier will also create or reuse change-sets assets in VersionOne and assoicates the build with the appropriate 
			story or defect. 
		</para>
		<para>
			Using this integration you can better answer the following questions: 
			<itemizedlist>
				<para/>
				<listitem>
					<para>For Defects</para>
					<itemizedlist>
						<listitem>
							<para>Which build the defect was reported against?</para>
						</listitem>
						<listitem>
							<para>Which build contained the fix for the defect?</para>
						</listitem>
						<listitem>
							<para>Which builds contain work for the defect?</para>
						</listitem>
					</itemizedlist>
				</listitem>
				<listitem>
					<para>For Stories (Backlog Item)</para>
					<itemizedlist>
						<listitem>
							<para>Which builds contain work for the story?</para>
						</listitem>
						<listitem>
							<para>Which build contained the completed story?</para>
						</listitem>
					</itemizedlist>
				</listitem>
				<listitem>
					<para>For Build Runs</para>
					<itemizedlist>
						<listitem>
							<para>Which defects were fixed?</para>
						</listitem>
						<listitem>
							<para>Which stories were completed?</para>
						</listitem>
						<listitem>
							<para>Which defects were introduced?</para>
						</listitem>
						<listitem>
							<para>When work for a story or defect was included?</para>
						</listitem>
						<listitem>
							<para>Which Change-sets were included?</para>
						</listitem>
					</itemizedlist>
				</listitem>
				<listitem>
					<para>For a range of Build Runs</para>
					<itemizedlist>
						<listitem>
							<para>Which stories were completed?</para>
						</listitem>
						<listitem>
							<para>Which defects were fixed?</para>
						</listitem>
						<listitem>
							<para>Which defects were introduced?</para>
						</listitem>
					</itemizedlist>
				</listitem>
			</itemizedlist>
		</para>
	</section>
	<section id="systemreqs">
		<title>System Requirements</title>
		<para>
			VersionOne: 8.1 or above 			
		</para>
		<para>
			Integration Server:
			<itemizedlist>
				<listitem>
					<para>Operating System—Windows 2000, 2003</para>
				</listitem>
			</itemizedlist>
		</para>
		<para>
			Continous Integration Server:
			<itemizedlist>
				<listitem>
					<para>Tested with TeamCity Version 4.0</para>
				</listitem>
			</itemizedlist>
		</para>
	</section>

	&downloads;

	<section id="installation">
		<title>Installation</title>
		<para>
			These installation instructions assume that <ulink
				url="http://www.jetbrains.com/teamcity/index.html"
			>TeamCity</ulink> is already installed, configured, and working properly. 
		</para>
		<section id="install.location">
			<title>1.  Ensure Connectivity</title>
			<para>Verify that you can connect to your VersionOne instance from the machine hosting TeamCity</para>
		</section>
		<section id="install.extract">
			<title>2.  Extract Files</title>
			<para>Download the TeamCity integration using the link above and extract it into a folder of your choice. This can be a temporary location since we will copy some of these files during TeamCity configuration..</para>
		</section>
		<section id="install.configure">
			<title>3.  Configure</title>
			<para>Configuration for Build Integration is a 2 step process. </para>
			<orderedlist>
				<listitem>
					<para>
						<link linkend="configuration.v1">Configure VersionOne</link>
					</para>
				</listitem>
				<listitem>
					<para>
						<link linkend="configuration.cc">Configure TeamCity</link>
					</para>
				</listitem>
			</orderedlist>
		</section>
		<section id="verify">
			<title>4. Verify the integration</title>
			<para>Once configuration is complete use the following steps to verify that the build integration is working</para>
			<orderedlist>
				<listitem>
					<para>Navigate to TeamCity</para>
				</listitem>
				<listitem>
					<para>Force a build on the project you configured</para>
				</listitem>
				<listitem>
					<para>Wait for build to complete</para>
				</listitem>
				<listitem>
					<para>Navigate to VersionOne</para>
				</listitem>
				<listitem>
					<para>Login</para>
				</listitem>
				<listitem>
					<para>Select VersionOne project in 'My Projects' dropdown</para>
				</listitem>
				<listitem>
					<para>Navigate to the Reports | Reports Overview page</para>
				</listitem>
				<listitem>
					<para>Select the "Build Run Quicklist" Report </para>
				</listitem>
			</orderedlist>
			<para>You should see an entry in the grid for the build you forced. If not, verify your configuration.</para>
		</section>
	</section>
	<section id="configuration">
		<title>Configuration</title>
		<section id="configuration.v1">
			<title>VersionOne Configuration</title>
			<orderedlist>
				<listitem>
					<para>Log into the VersionOne application as admin</para>
				</listitem>
				<listitem>
					<para>Navigate to the Admin | Configuration | System page.</para>
				</listitem>
				<listitem>
					<para>Check the “Enable Build Integration” checkbox and click the Apply button.</para>
					<figure>
						<title/>
						<graphic fileref="EnableBuildIntegration.jpg"/>
					</figure>
				</listitem>
				<listitem>
					<para>Navigate to the Admin | Projects | Build Project page</para>
					<figure>
						<title/>
						<graphic fileref="BuildProjects.jpg"/>
					</figure>
				</listitem>
				<listitem>
					<para>Click Add to add a new Build Project</para>
				</listitem>
				<listitem>
					<para>Specify the following</para>
					<orderedlist>
						<listitem>
							<para>Name – this is how the Build Project will be known to VersionOne users</para>
						</listitem>
						<listitem>
							<para>Reference – this is how the Build Project is known to Cruise Control</para>
						</listitem>
					</orderedlist>
				</listitem>
				<listitem>
					<para>Click Ok to save the new Build Project</para>
				</listitem>
				<listitem>
					<para>Navigate to the Admin | Projects | Projects page</para>
				</listitem>
				<listitem>
					<para>Click Edit on the row for the project you want associated with a Build Project</para>
				</listitem>
				<listitem>
					<para>Using the “Build Projects” dropdown add the appropriate Build Project.</para>
					<figure>
						<title/>
						<graphic fileref="AssignBuildProjectToProject.jpg"/>
					</figure>
				</listitem>
				<listitem>
					<para>Click Ok to accept the changes</para>
				</listitem>
				<listitem>
					<para>Logout</para>
				</listitem>
			</orderedlist>
		</section>
		<section id="configuration.cc">
			<title>TeamCity Configuration</title>
			<para>This section describes how to configure TeamCity for use with VersionOne</para>
			<orderedlist>
				<listitem>
					<para>Copy the following files into {TeamCity Install Dir}/webapps/ROOT/WEB-INF/lib</para>
					<para>
						<itemizedlist>
							<listitem><para>V1Notificator.jar</para></listitem>
							<listitem><para>VersionOne.APIClient.jar</para></listitem>
							<listitem><para>VersionOne.ObjectModel.jar</para></listitem>
						</itemizedlist>
					</para>
				</listitem>
				<listitem><para>Restart the TeamCity application server for these changes to take effect</para></listitem>
				<listitem><para>Open a browser and navigate to your TeamCity URL</para></listitem>
				<listitem><para>Either Create a TeamCity user for VersionOne or login as an existing TeamCity user</para>
					<note><para>You only need to enable notification for one users.  If you configure VersionOne notification for multiple users, it will increase processing time and network traffic.</para></note>
				</listitem>
				<listitem><para>Navigate to the "Settings and Tools" page for this user</para></listitem>
				<listitem><para>Click the "Edit" link for the VersionOne Integration</para></listitem>
				<listitem>
					<para>Configure the integration setting based on the following table</para>
					<para>
						<table>
							<title/>
							<tgroup cols="5">
								<thead>
									<row>
										<entry>Parameter</entry>
										<entry>Description</entry>
										<entry>Type</entry>
										<entry>Required</entry>
										<entry>Default</entry>
									</row>
								</thead>
								<tbody>
									<row>
										<entry>Server URL</entry>
										<entry>The URL of the VersionOne Application. For example: http://server/VersionOne/</entry>
										<entry>String</entry>
										<entry>True</entry>
										<entry/>
									</row>
									<row>
										<entry>Username</entry>
										<entry>The VersionOne member name used to connect to Server URL.</entry>
										<entry>String</entry>
										<entry>(varies)</entry>
										<entry/>
									</row>
									<row>
										<entry>Password</entry>
										<entry>The password for the specified member</entry>
										<entry>String</entry>
										<entry>(varies)</entry>
										<entry/>
									</row>
									<row>
										<entry>Comment RegEx</entry>
										<entry>The regular expression to use when matching primary workitems (stories and defects) with change comments. </entry>
										<entry>String</entry>
										<entry>True</entry>
										<entry>[A-Z]{1,2}-[0-9]+</entry>
									</row>
									<row>
										<entry>Attribute to Match</entry>
										<entry>The system name of an attribute to search when matching primary workitems (stories and defects) with change comments. </entry>
										<entry>String</entry>
										<entry>True</entry>
										<entry>Number</entry>
									</row>
								</tbody>
							</tgroup>
						</table>
					</para>
					
				</listitem>
				<listitem><para>Save these changes</para></listitem>
				<listitem><para>Click the link to Add a new Rule</para></listitem>
				<listitem><para>Choose "Watch builds from selected build configurations" </para></listitem>
				<listitem><para>Select the builds you want to watch, or choose All Projects</para></listitem>
				<listitem>
					<para>Select the following notification options
						<itemizedlist>
							<listitem><para>The build fails</para></listitem>
							<listitem><para>The build is successful</para></listitem>
						</itemizedlist>
						<note><para>Do not select other build options.  Doing so will increase network traffic and the number of build run records in VersionOne</para></note>
					</para>
				</listitem>
			</orderedlist>
			<para>Here's an example configuration
				<figure>
					<title/>
					<graphic fileref="TeamCityConfig.jpg"/>
				</figure>
			</para>
		</section>
	</section>
	<section id="section.footer">
		<title/>
		<para>Copyright &copy; <?dbtimestamp format="Y"?>, VersionOne, Inc. All rights reserved. This document was generated <?dbtimestamp format="Y-m-d H:M:S"?>.</para>
	</section>
</article>
